<biosimulations-text-page heading="Tutorial" [tocSections]="tocSections">
  <ng-container id="sideBar">
    <biosimulations-text-page-side-bar-section heading="Related resources" fxShow fxHide.lt-md>
      <div class="hanging-indent">
        <a [href]="config.apiUrl" target="_blank">
          <biosimulations-icon icon="link"></biosimulations-icon>
          REST API documentation
        </a>
      </div>
    </biosimulations-text-page-side-bar-section>

    <biosimulations-text-page-help-side-bar-section fxShow fxHide.lt-md>
    </biosimulations-text-page-help-side-bar-section>

    <biosimulations-text-page-feedback-side-bar-section fxShow fxHide.lt-md>
    </biosimulations-text-page-feedback-side-bar-section>
  </ng-container>

  <ng-container id="content" tocSectionsContainer>
     <biosimulations-text-page-content-section
      heading="Creating a COMBINE/OMEX file for a modeling project"
      tocSection="Creating modeling projects"
    >
      <p>
        The containerized biosimulation tools in the BioSimulators registry require modeling projects (one or more simulations of one or more models) to be described by an OMEX file and packaged into a COMBINE archive. Please follow these steps to create OMEX and COMBINE files. Alternatively, COMBINE/OMEX files which describe modeling projects can be obtained from the BioSimulations repository of modeling projects <a href="https://biosimulations.org" target="_blank"><biosimulations-icon icon="link"></biosimulations-icon></a>.
      </p>

      <ol class="vertically-spaced">
        <li>
          <b>Create a directory for the modeling project.</b>
        </li>
        <li>
          <b>Create one or more models:</b>
          Create files which describe the models that you would like to simulate and save these files to the directory for the modeling project. Currently, the simulations tools in the BioSimulators collection support the BioNetGen Language <a href="https://bionetgen.org" target="_blank"><biosimulations-icon icon="link"></biosimulations-icon></a> (BNGL) and Systems Biology Markup Language <a href="http://sbml.org" target="_blank"><biosimulations-icon icon="link"></biosimulations-icon></a> (SBML) formats. More information about BNGL and SBML is available from their websites. Alternatively, models can be obtained from BioModels <a href="https://www.ebi.ac.uk/biomodels/" target="_blank"><biosimulations-icon icon="link"></biosimulations-icon></a>, BioSimulations <a href="https://biosimulations.org" target="_blank"><biosimulations-icon icon="link"></biosimulations-icon></a>, and other model repositories.
        </li>
        <li>
          <b>Create or more simulations:</b>
          Create a Simulation Experiment Description Markup Language <a href="https://sed-ml.org" target="_blank"><biosimulations-icon icon="link"></biosimulations-icon></a> (SED-ML) file which describes the simulations that you would like to execute and the simulation results that you would like to record. Currently, all of the simulation tools support a subset of SED-ML including one step and timecourse simulations (<code>sedml:OneStep</code> and <code>sedml:UniformTimeCourse</code>), individual simulation tasks (<code>sedml:Task</code>), data generators for time and individual variables (<code>sedml:DataGenerator</code>), and report outputs (<code>sedml:Report</code>). Some of the simulation tools support the full SED-ML specification including steady-state simulations (<code>sedml:SteadyState</code>), repeated tasks (<code>sedml:RepeatedTask</code>), data generators for mathematical expressions (<code>sedml:DataGenerator</code>), and plot outputs (<code>sedml:Plot2d</code> and <code>sedml:Plot3d</code>). Save these files to the directory for the modeling project. More information about SED-ML is available from the SED-ML website. Alternatively, simulations can be obtained from the BioSimulations repository of modeling projects <a href="https://biosimulations.org" target="_blank"><biosimulations-icon icon="link"></biosimulations-icon></a>.
        </li>
        <li>
          <b>Create an OMEX file which describes your model and simulation files and package them into a COMBINE archive file:</b>
          OMEX is a format for describing a collection of modeling files, and a COMBINE archive is a zip file which contains an OMEX file and all of the other files which comprise the modeling project. Several example COMBINE archives are available in the BioSimulators test suite <a href="Biosimulators_test_suite" target="_blank"><biosimulations-icon icon="link"></biosimulations-icon></a>. More information about the OMEX and COMBINE formats is available at the COMBINE website <a href="https://combinearchive.org/" target="_blank"><biosimulations-icon icon="link"></biosimulations-icon></a>. The COMBINE website lists several software tools for creating COMBINE archives including COMBINE Archive <a href="https://combinearchive.org/" target="_blank"><biosimulations-icon icon="link"></biosimulations-icon></a> and COMBINE Archive Web <a href="https://cat.bio.informatik.uni-rostock.de/" target="_blank"><biosimulations-icon icon="link"></biosimulations-icon></a>.
        </li>
      </ol>
    </biosimulations-text-page-content-section>

    <biosimulations-text-page-content-section
      heading="Finding a simulation tool that is capable of executing a modeling project"
      tocSection="Finding simulation tools"
    >
      The simulation tools in the BioSimulators collection support different modeling frameworks, different simulation algorithms, and different model formats. The simulators page <a [routerLink]="['/simulators']"><biosimulations-icon icon="internalLink"></biosimulations-icon></a> outlines the modeling frameworks, simulation algorithms, and model formats supported by each tool. After determining the framework and format of your model and the simulation algorithm which you would like to execute, use this page to identify a simulation tool which is capable of executing your modeling project.
    </biosimulations-text-page-content-section>

    <biosimulations-text-page-content-section
      heading="Using a containerized simulation tool to execute a simulation"
      tocSection="Executing simulations"
    >
      <p>Two web applications are available for using the BioSimulators simulation tools to execute simulations. runBioSimulations <a href="https://run.biosimulations.org" target="_blank"><biosimulations-icon icon="link"></biosimulations-icon></a> is a simple application that uses BioSimulators to execute modeling studies. BioSimulations <a href="https://biosimulations.org" target="_blank"><biosimulations-icon icon="link"></biosimulations-icon></a> is a platform for publishing modeling studies that also uses BioSimulators to executed published modeling studies.</p>

      <p>The BioSimulators simulation tools can also be used to execute simulations on your own machine. Please follow these steps to use a containerized simulation tool to execute a modeling study on your own machine.</p>

      <ol class="vertically-spaced">
        <li>
          <b>Install the Docker container engine:</b>
          Detailed instructions for all major operating systems are available from the Docker website <a href="https://docs.docker.com/get-docker/" target="_blank"><biosimulations-icon icon="link"></biosimulations-icon></a>.
        </li>
        <li>
          <b>Download the simulator(s) that you wish to use:</b>
          From your console, execute <code>docker pull biosimulators/{{ '{' }} simulator-id {{ '}' }}</code> for each simulator that you wish to use. This will download the simulators and install them onto your machine.
        </li>
        <li>
          <p><b>Use the selected simulator(s) to execute simulations and save their results:</b>
          Execute the following from your console:</p>

          <pre><code>docker run \
  --tty \
  --rm \
  --mount type=bind,source={{ '{' }} path-to-directory-of-COMBINE-archive {{ '}' }},target=/tmp/project,readonly \
  --mount type=bind,source={{ '{' }} path-to-save-results {{ '}' }},target=/tmp/results \
  biosimulators/{{ '{' }} simulator-id {{ '}' }} \
    --archive /tmp/project/{{ '{' }} name-of-COMBINE-archive {{ '}' }} \
    --out-dir /tmp/results</code></pre>

          <p>Your COMBINE archive should be located at <code>path-to-directory-of-COMBINE-archive/name-of-COMBINE-archive</code>. This will save your results to <code>path-to-save-results</code>. Reports will be saved in CSV format and plots will be saved in PDF format.</p>
        </li>
      </ol>
    </biosimulations-text-page-content-section>

    <biosimulations-text-page-content-section
      heading="Programmatically retrieving information about simulation tools via the REST API"
      tocSection="REST API"
    >
      An API is available for retrieving information about the simulation tools in the BioSimulators collection. Please see the documentation for the REST API <a [href]="config.apiUrl" target="_blank"><biosimulations-icon icon="link"></biosimulations-icon></a> for more information.
    </biosimulations-text-page-content-section>

    <biosimulations-text-page-content-section
      heading="Developing a BioSimulators-compliant containerized biosimulation tool"
      tocSection="Developing simulation tools"
    >
      <p>We welcome contributions of additional simulation tools!</p>

      <p>All simulation tools submitted to BioSimulators should support at least one modeling language, SED-ML, KiSAO, and COMBINE/OMEX.</p>
      <ul class="vertically-spaced">
        <li><b>Modeling languages.</b> Containers should support at least a subset of at least one modeling language such as BGNL, CellML, Kappa, NeuroML, pharmML, or SBML.</li>
        <li><b>SED-ML.</b> Currently, containers should support at least the following features of SED-ML:
          <ul>
            <li>One step and timecourse simulations: <code>sedml:OneStep</code> and <code>sedml:UniformTimeCourse</code>.</li>
            <li>Individual simulation tasks: <code>sedml:Task</code>.</li>
            <li>Gata generators for time and individual variables: <code>sedml:DataGenerator</code></li>
            <li>Report outputs: <code>sedml:Report</code>.</li>
          </ul>
        <li><b>KiSAO.</b> SED-ML documents interpreted by containers should use KiSAO terms to indicate algorithms and algorithm parameters. As necessary, use the KiSAO issue tracker <a href="https://sourceforge.net/p/kisao/feature-requests/new/" target="_blank"><biosimulations-icon icon="link"></biosimulations-icon></a> to request terms for additional algorithms and algorithm parameters.</li>
        <li><b>COMBINE/OMEX.</b> Containers should support the full COMBINE/OMEX specification.</li>
      </ul>

      <p>Please follow the steps below to create a containerized simulation tool that adheres to the BioSimulators standards. Several examples are available from the BioSimulators GitHub organization <a href="https://github.com/biosimulations/" target="_blank"><biosimulations-icon icon="link"></biosimulations-icon></a>. A template repository with template Python code for a command-line interface and a template for a Dockerfile is available here <a href="https://github.com/biosimulators/Biosimulators_simulator_template" target="_blank"><biosimulations-icon icon="link"></biosimulations-icon></a>.
      </p>
    
      <ol class="vertically-spaced">
        <li><b>Optionally, create a Git repository for your command-line interface and Dockerfile.</b></li>
        <li>
          <p><b>Implement a BioSimulators-compliant command-line interface to your simulation tool.</b> The interface should accept two keyword arguments:</p>
          <ul>
            <li><code>-i, --archive</code>: A path to a COMBINE archive which contains descriptions of one or more simulation tasks.</li>
            <li><code>-o, --out-dir</code>: A path to a directory where the outputs of the simulation tasks should be saved. Reports should be saved in CSV format and plots should be saved in PDF format. The simulator should create a directory to contain the output of each SED-ML document. This should have the same path relative to the top-level output directory as the SED-ML file to the root of the archive. The file name of each output should be the id of the output plus the one of the extensions .csv or .pdf.</li>
          </ul>

          <p>In addition, we recommend providing optional arguments for reporting help and version information about your simulator:</p>
          <ul>
            <li><code>-h, --help</code>: This argument should instruct the command-line program to print help information about itself.</li>
            <li><code>-v, --version</code>: This argument should instruct the command-line program to report version information about itself.</li>
          </ul>
        </li>
        <li><b>Create a Dockerfile which describes how to build an image for your simulation tool.</b>
          <ul>
            <li>Use the <code>FROM</code> directive to choose a base operating system such as Ubuntu.</li>
            <li>Use the <code>RUN</code> directive to describe how install your tool and any dependencies.</li>
            <li>Set the <code>ENTRYPOINT</code> directive to the path to your command-line interface.</li>
            <li>Set the <code>CMD</code> directive to <code>[]</code>.</li>
            <li>
              <p>Use the <code>LABEL</code> directive to provide the metadata about your simulation tool described below. This metadata is necessary to also submit your image to BioContainers <a href="https://biocontainers.pro" target="_blank"><biosimulations-icon icon="link"></biosimulations-icon></a>, a broad registry of images for biological research.</p>
              <ul>
                <li><code>version</code>: the version of your image (e.g., <code>1.0.0</code>)</li>
                <li><code>software</code>: the simulation program wrapped into your image (e.g., <code>BioNetGen</code>).</li>
                <li><code>software.version</code>: the version of the simulation program wrapped into your image (e.g., <code>2.5.0</code>).</li>
                <li><code>about.summary</code>: short description of the simulation tool (e.g., <code>Package for rule-based modeling of complex biochemical systems</code>).</li>
                <li><code>about.home</code>: URL for the simulation tool (e.g., <code>https://bionetgen.org/</code>).</li>
                <li><code>about.documentation</code>: URL for documentation for the simulation program (e.g., <code>https://bionetgen.org/</code>).</li>
                <li><code>about.license_file</code>: URL for the license for the simulation program (e.g., <code>https://github.com/RuleWorld/bionetgen/blob/master/LICENSE</code>).</li>
                <li><code>about.license</code>: SPDX license id for the license for the simulation program (e.g., <code>SPDX:MIT</code>). See SPDX <a href="https://spdx.dev/" target="_blank"><biosimulations-icon icon="link"></biosimulations-icon></a> for a list of licenses and their ids.</li>
                <li><code>about.tags</code>: comma-separated list of tags which describe the simulation tool (e.g., <code>rule-based modeling,dynamical simulation,systems biology,BNGL,BioSimulators</code>). Plese include the tag <code>BioSimulators</code>.</li>
                <li><code>extra.identifiers.biotools</code>: optionally, the bio.tools identifier for the simulation program (e.g., <code>bionetgen</code>). Visit bio.tools <a href="https://bio.tools/" target="_blank"><biosimulations-icon icon="link"></biosimulations-icon></a> to request an identifier for your simulation program.</li>
                <li><code>maintainer</code>: the name and email of the person/team who developed the image (e.g., <code>Jonathan Karr &lt;karr@mssm.edu&gt;</code>).</li>
              </ul>

              <p>Below is an example of metadata for the BioNetGen image.</p>
              <pre><code [languages]="['dockerfile']" highlight="LABEL base_image=&quot;ubuntu:18.04&quot;
LABEL version=&quot;1.0.0&quot;
LABEL software=&quot;BioNetGen&quot;
LABEL software.version=&quot;2.5.0&quot;
LABEL about.summary=&quot;Package for rule-based modeling of complex biochemical systems&quot;
LABEL about.home=&quot;https://bionetgen.org/&quot;
LABEL about.documentation=&quot;https://bionetgen.org/&quot;
LABEL about.license_file=&quot;https://github.com/RuleWorld/bionetgen/blob/master/LICENSE&quot;
LABEL about.license=&quot;SPDX:MIT&quot;
LABEL about.tags=&quot;rule-based modeling,dynamical simulation,systems biology,biochemical networks,BNGL,SED-ML,COMBINE,OMEX,BioSimulators&quot;
LABEL extra.identifiers.biotools=&quot;bionetgen&quot;
LABEL maintainer=&quot;Jonathan Karr &lt;karr@mssm.edu&gt;&quot;"></code></pre>
          </ul>
        </li>
        <li>
          <p><b>Use Docker and the Dockerfile to build an image for your simulation tool</b> by executing the following from your console:</p>
          <pre><code>docker build \
  --tag {{ '{' }} dockerhub-user-id {{ '}' }}/{{ '{' }} simulator-id {{ '}' }}:{{ '{' }} simulator-version {{ '}' }} \
  --tag {{ '{' }} dockerhub-user-id {{ '}' }}/{{ '{' }} simulator-id {{ '}' }}:latest \
  --file {{ '{' }} path-to-Dockerfile {{ '}' }} \
  .</code></pre>
        </li>
        <li>
          <p><b>Create a JSON-formatted file which specifies the capabilities of your simulation tool.</b> This file should adhere to the schema described in the BioSimulators API <a href="https://api.biosimulators.org"><biosimulations-icon icon="link"></biosimulations-icon></a>.</p>
          <p>Use SBO, KiSAO, and EDAM to describe the modeling frameworks, simulation algorithms, and modeling formats that your simulation tool supports. As necessary, use the following issue trackers to request additional SBO <a href="https://sourceforge.net/p/sbo/term-request/"><biosimulations-icon icon="link"></biosimulations-icon></a>, KiSAO <a href="https://sourceforge.net/p/kisao/feature-requests/new/"><biosimulations-icon icon="link"></biosimulations-icon></a>, and EDAM <a href="https://github.com/edamontology/edamontology/issues/new?template=new-format.md"><biosimulations-icon icon="link"></biosimulations-icon></a> terms. As necessary, also use the SED-ML issue tracker <a href="https://github.com/SED-ML/sed-ml/issues/new"><biosimulations-icon icon="link"></biosimulations-icon></a> to request URNs for additional modeling languages. Currently, there is no process to request additional model format specification URLs for using COMBINE with additional model formats.</p>
        </li>
        <li>
          <p><b>Use the BioSimulators test suite to validate your image and its specificiations.</b> This will check that the image provides a BioSimulators-compliant Docker structure and command-line interface, and that it provides all of the simulation algorithms described in its specifications.</p>
          <pre><code>pip install biosimulators-test-suite
biosimulators-test-suite validate {{ '{' }} dockerhub-user-id {{ '}' }}/{{ '{' }} image-id {{ '}' }} {{ '{' }} path-to-specifications.json {{ '}' }}</code></pre>
        </li>
      </ol>
    </biosimulations-text-page-content-section>

    <biosimulations-text-page-content-section
      heading="Contributing a containerized biosimulation tool to BioSimulators"
      tocSection="Contributing simulation tools"
    >
      <p>We welcome contributions of additional simulation tools! Please follow these steps to contribute a tool to BioSimulators:</p>
      <ol class="vertically-spaced">
        <li>
          <b>Publish your image to a public repository</b> such as Docker Hub <a href="https://dockerhub.com/" target="_blank"><biosimulations-icon icon="link"></biosimulations-icon></a>, GitHub Container Registry <a href="https://github.com/features/packages" target="_blank"><biosimulations-icon icon="link"></biosimulations-icon></a>, or Quay <a href="https://quay.io/" target="_blank"><biosimulations-icon icon="link"></biosimulations-icon></a> by executing <code>docker push {{ '{' }} image-url {{ '}' }}</code>. Docker Hub, GitHub Container Registry, and Quay each provide free accounts for public images.
        </li>
        <li>
          <b>Submit an issue <a href="https://github.com/biosimulators/Biosimulators/issues/new?assignees=&labels=Submit+simulator&template=contribute-a-simulator.md&title=" target="_blank"><biosimulations-icon icon="link"></biosimulations-icon></a></b> to the BioSimulators GitHub repository that describes briefly describes the URL to the specifications of your tool. This will initiate an automated workflow which will validate your simulation tool and either commit your tool to the BioSimulators registry or report problems with your simulation tool which must be addressed. The first version of each simulation tool submitted to the BioSimulators registry will also be manually reviewed by the BioSimulators Team prior to incorporation into the BioSimulators registry.
        </li>
        <li>
          <p><b>Optionally, set up your continuous integration workflow to automatically push each release to BioSimulators.</b> Within your continuous integration workflow (e.g., CircleCI, GitHub actions, Jenkins, Travis), use the GitHub REST API to automatically create issues that submit versions of your simulator to BioSimulators.</p>

          <p>This requires a GitHub account and a personal access token with the <code>public_repo</code> scope. Instructions for creating an access token are available in the GitHub documentation <a href="https://docs.github.com/en/free-pro-team@latest/github/authenticating-to-github/creating-a-personal-access-token"><biosimulations-icon icon="link"></biosimulations-icon></a>.</p>

          <ul>
            <li>Endpoint: <code>http://api.github.com/repos/biosimulators/Biosimulators/issues</code></li>
            <li>Method: <code>POST</code></li>
            <li>Auth: <code>{{ '{' }} github-username {{ '}' }}:{{ '{' }} github-person-access-token {{ '}' }}</code></li>
            <li>Headers: 
              <ul>
                <li>Accept: <code>application/vnd.github.v3+json</code></li>
              </ul>
            </li>
            <li>Body (JSON-encoded)
              <ul>
                <li>title: <code>Submit {{ '{' }} simulator-name {{ '}' }} {{ '{' }} simulator-version {{ '}' }}</code></li>
                <li>body: <pre><code>---
name: {{ '{' }} simulator-name {{ '}' }}
version: {{ '{' }} simulator-version {{ '}' }}
specificationsUrl: {{ '{' }} specifications-url {{ '}' }}

---</code></pre>
                </li>
              </ul>
            </li>
          </ul>

          <p class="no-bottom-margin">curl code sample:</p>

          <pre><code>curl \
  -X POST \
  -u jonrkarr:********* \
  -H "Accept: application/vnd.github.v3+json" \
  https://api.github.com/repos/biosimulators/Biosimulators/issues \
  -d '{{ '{' }}"labels": ["Submit simulator"], "title": "Submit tellurium 2.1.6", "body": "---\nname: tellurium\nversion: 2.1.6\nspecificationsUrl: https://raw.githubusercontent.com/biosimulators/Biosimulators_tellurium/2.1.6/biosimulators.json\n\n---"{{ '}' }}'</code></pre>

          <p>The above is implemented by the Python method <code>Biosimulations_utils.simulator.submit_to_biosimulators.submit_simulator_to_biosimulators</code>. See the documentation <a href="https://biosimulations-utils.readthedocs.io/"><biosimulations-icon icon="link"></biosimulations-icon></a> for more information.</p>
        </li>
        <li>
          <b>Optionally, also publish the source code for your simulation tool to a repository</b> such as BitBucket <a href="https://bitbucket.org/" target="_blank"><biosimulations-icon icon="link"></biosimulations-icon></a>, GitHub <a href="https://github.com/" target="_blank"><biosimulations-icon icon="link"></biosimulations-icon></a>, or GitLab <a href="https://gitlab.com/" target="_blank"><biosimulations-icon icon="link"></biosimulations-icon></a>.
        </li>
        <li>
          <b>Optionally, also publish your simulation tool to a software repository</b> such as CRAN <a href="https://cran.r-project.org/" target="_blank"><biosimulations-icon icon="link"></biosimulations-icon></a> (R), NPM <a href="https://www.npmjs.com/" target="_blank"><biosimulations-icon icon="link"></biosimulations-icon></a> (JavaScript), or PyPi <a href="https://pypi.org/" target="_blank"><biosimulations-icon icon="link"></biosimulations-icon></a> (Python).
        </li>
        <li>
          <b>Optionally, also register your tool with bio.tools.</b> Visit bio.tools <a href="https://bio.tools" target="_blank"><biosimulations-icon icon="link"></biosimulations-icon></a> to submit your tool to their regsitry of research tools.
        </li>
        <li>
          <b>Optionally, also submit your Dockerfile to BioContainers.</b> BioContainers accepts contributions via pull requests. See the BioContainers image registry <a href="https://github.com/BioContainers/containers/pulls" target="_blank"><biosimulations-icon icon="link"></biosimulations-icon></a> for more information.
        </li>
      </ol>
    </biosimulations-text-page-content-section>

    <biosimulations-text-page-content-section
      heading="Contributing to the BioSimulators platform"
      tocSection="Contributing to the platform"
    >
      <p>We welcome contributions to the BioSimulators platform (e.g., web application, REST API, database)! Please see the Guide to Contributing <a href="https://github.com/biosimulations/Biosimulations/blob/dev/CONTRIBUTING.md" target="_blank"><biosimulations-icon icon="link"></biosimulations-icon></a> for information about how to contribute to the platform.</p>
    </biosimulations-text-page-content-section>
  </ng-container>
</biosimulations-text-page>